<!DOCTYPE html>
<html lang="en">

    <head>
        <title>Activity</title>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <!--===============================================================================================-->
        <!-- <link rel="icon" type="image/png" href="images/icons/favicon.ico"/> -->
        <!--===============================================================================================-->
        <link rel="stylesheet" type="text/css" href="<%=url%>/vendor/bootstrap/css/bootstrap.min.css" />
        <!--===============================================================================================-->
        <link rel="stylesheet" type="text/css" href="<%=url%>/fonts-1/font-awesome-4.7.0/css/font-awesome.css" />
        <!--===============================================================================================-->
        <link rel="stylesheet" type="text/css" href="<%=url%>/css/main.css" />
        <!--===============================================================================================-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.3/TweenMax.min.js"></script>
        <link rel="stylesheet" type="text/css" href="<%=url%>/css/style_2.css" />
        <link rel="stylesheet" type="text/css" href="<%=url%>/toastr/toastr.min.css" />
        <!--===============================================================================================-->
    </head>



    <body>
        <div class="limiter">
            <div class="container-profile100">
                <div class="header w-100">
                    <div class="cover-image100">
                        <img src="<%=url%>/logo/logo.png" class="pep-logo" alt="" />
                        <a href="#">
                            <span class="fa fa-bars menu-button" onclick="openMenu()"></span>
                        </a>
                        <a href="<%=url%>/user/notification">
                            <span class="fa fa-bell menu-button">
                        </a>
                        <nav id="menu">
                            <ul>
                                <% permissions.forEach(element=> { %>
                                    <li>
                                        <a href="<%=url%>/user<%= element.controller %>/<%=info.uuid%>">
                                            <span class="<%= element.icon%>"></span>
                                            <%= element.permission_name %>
                                        </a>
                                    </li>
                                    <% }); %>
                                        <li>
                                            <a href="<%=url%>/user/signout">
                                                <span class="fa fa-sign-out"> </span> Log Out</a>
                                        </li>
                            </ul>
                            <span class="fa fa-times close-menu" onclick="closeMenu()"></span>
                        </nav>
                    </div>
                    <div class="col-12  salesup">
                    
                    <div class="row">
                       
                        <div class="col-6 col-sm-6 col-md-8 col-lg-9 col-xl-9">
                            <div class="congrats">
                                <h1>Congragulations!</h1>
                            </div>
                            <div class="row">
                                <div class="col-8">
                                    <h4 id="order number"> Activity ID# <%=Activity_Info.list_act_uuid %>
                                    </h4>
                                    <h6 class="mt-3">Agency Name :<b>
                                            <%=agencyInfo.Agency_Info.agency_name%>
                                        </b>
                                    </h6>
                                    <h6 class="mt-3">Date :<b>
                                            <%=Activity_Info.createdAt%>
                                        </b>
                                    </h6>
                                </div>
                                <div class="col-4">
                                    <h4 id="amount_earned" class="amountheading">
                                    </h4>
                                </div>
                            </div>
                            <div class="table-responsive overflow my-4" >
                                <table class="table text-nowrap " id="depositedSlipTable" name="table">
                                  <thead class="table-primary">
                                  <tr>
                                    <th scope="col">#</th>
                                    <th scope="col">List Name</th>
                                    <th scope="col">Bank</th>
                                    <th scope="col">Commission</th>
                                    <th scope="col">Bank Amount</th>
                                    <th scope="col">Amount</th>
                                  </tr>
                                </thead>
                                <tbody>
                                    <% subActivities.forEach((element,index)=> {%>
                                        <td>
                                            <%=++index %>
                                        </td>
                                        <td><%=element.List_of_Package.list_name %>
                                        </td>
                                        <% if(element.List_of_Package.isBank===true){ %>
                                            <td>Yes</td>
                                            <%}else{%>
                                                <td>No</td>
                                                <%}%>
                                                <% if(element.List_of_Package.commissionAmount===0){ %>
                                                    <td>--</td>
                                                    <%}else{%>
                                                        <td><%=element.List_of_Package.commissionAmount%> %</td>
                                                            <%}%>
                                                            <% if(element.List_of_Package.bankAmount===null){ %>
                                                                <td>--</td>
                                                                <%}else{%>
                                                                    <td><%=element.List_of_Package.bankAmount %> PKR</td>
                                                                    <%}%>
                                        <td><%=element.List_of_Package.list_amount %> PKR</td>

                                        <%})%>
                                        </table>


                        </div>
                          </div>
                        
                        <div class="col-6 col-sm-6 col-md-4 col-lg-3 col-xl-3 ">

                            <div class="card text-center p-0">
                                <div class="card-body background-border">
                                    <p class="card-text"> Need to contact customer support service??</p>
                                    <button id="contactUS" class="btn btn-primary p-1 ">Contact</button>
                                </div>
                            </div>
                            <div class="card text-center background-border p-0" id="bankDepositSection" style="display: none;"  >
                                <div class="card-body text-center">
                                    <p class="card-text font-weight-bold "> Bank Deposit</p>
                                    <button id="bankDepositBTN" class="btn btn-primary p-1">Click <i class="fa fa-arrow-up" aria-hidden="true"></i></button>
                                </div>
                            </div>

                        </div>
                      


                    </div>
                    </div>
                    </div>
                    </div>
                    







                 
        <!--===============================================================================================-->
        <script src="<%=url%>/vendor/jquery/jquery-3.2.1.min.js"></script>
        <!--===============================================================================================-->
        <script src="<%=url%>/vendor/bootstrap/js/bootstrap.min.js"></script>
        <!--===============================================================================================-->
        <script src="<%=url%>/vendor/jquery/tilt.jquery.min.js"></script>

        <script src="<%=url%>/toastr/toastr.min.js"></script>

        <script>
            var menu = document.getElementById("menu");
            function openMenu() {
                menu.style.top = "0";
            }
            function closeMenu() {
                menu.style.top = "-100vh";
            }
            var notificationCount = JSON.parse('<%-JSON.stringify(unreadNotificationCount)%>')
            if (notificationCount) {
                $('.button__badge').css('display', 'block')
                $('.button__badge').html(JSON.parse('<%-JSON.stringify(unreadNotificationCount)%>'))
            }
            console.log(JSON.parse('<%-JSON.stringify(sumOf_Activities)%>'));
            var sumOfActivities = JSON.parse('<%-JSON.stringify(sumOf_Activities)%>');
            console.log(sumOfActivities);

            $('#amount_earned').html(parseInt(sumOfActivities.SumofValues) + Math.ceil(sumOfActivities.Commission) + " PKR");
            $('#totalamount_earned').html(parseInt(sumOfActivities.SumofValues) + Math.ceil(sumOfActivities.Commission) + " PKR");
            if (sumOfActivities.Commission) {
                $('#commissionEarned').html(sumOfActivities.Commission.toFixed(2) + " PKR")
                $('#bankDepositSection').css('display', 'block')
                var activities = JSON.parse('<%-JSON.stringify(subActivities)%>');
                var BankAmount = 0;
                activities.map(info => {
                    if (info.List_of_Package.isBank) {
                        BankAmount += info.List_of_Package.bankAmount
                    }

                })

                $('#bankdepositAmount').css('color', 'red')
                $('#bankdepositAmount').html(BankAmount.toFixed(0) + ' PKR')
            }
            else {
                $('#commissionEarned').html("     --")
                $('#bankdepositAmount').html('   --')
            }

            $('#bankDepositBTN').click(e => {
                var activity_Info = JSON.parse('<%-JSON.stringify(Activity_Info)%>');
                window.open(`${window.location.origin}/user/bankDeposit/${activity_Info.list_act_uuid}`, '_blank')
            });

            $('#contactUS').click(e => {
                var activity_Info = JSON.parse('<%-JSON.stringify(Activity_Info)%>');
                window.open(`${window.location.origin}/user/contactUs/${activity_Info.list_act_uuid}`, '_blank')
            });
        </script>
        <script>
            $(function () {
                var numberOfStars = 100;

                for (var i = 0; i < numberOfStars; i++) {
                    $('.congrats').append('<div class="blob fa fa-star ' + i + '"></div>');

                }

                animateText();

                animateBlobs();
            });

            $('.congrats').click(function () {
                reset();

                animateText();

                animateBlobs();
            });

            function reset() {
                $.each($('.blob'), function (i) {
                    TweenMax.set($(this), { x: 0, y: 0, opacity: 1 });
                });

                TweenMax.set($('h1'), { scale: 1, opacity: 1, rotation: 0 });
            }

            function animateText() {
                TweenMax.from($('h1'), 0.8, {
                    scale: 0.4,
                    opacity: 0,
                    rotation: 15,
                    ease: Back.easeOut.config(4),
                });
            }

            function animateBlobs() {
                var xSeed = Math.ceil(Math.random() * 350) + 380;
                var ySeed = Math.floor(Math.random() * 5) + 170;

                $.each($(".blob"), function (i) {
                    var $blob = $(this);
                    var speed = Math.floor(Math.random() * 1) + 5;
                    var rotation = Math.floor(Math.random() * 5) + 100;
                    var scale = Math.floor(Math.random() * 0.8) + 1.5;
                    var x = Math.floor(Math.random() * -xSeed) + xSeed;
                    var y = Math.floor(Math.random() * -ySeed) + ySeed;

                    TweenMax.to($blob, speed, {
                        x: x,
                        y: y,
                        ease: Power1.easeOut,
                        opacity: 0,
                        rotation: rotation,
                        scale: scale,
                        onStartParams: [$blob],
                        onStart: function ($element) {
                            $element.css("display", "block");
                        },
                        onCompleteParams: [$blob],
                        onComplete: function ($element) {
                            $element.css("display", "none");
                        },
                    });
                });
            }
        </script>
    </body>

</html>