<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Assign Area</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/gh/bbbootstrap/libraries@main/choices.min.css"
    />
    <script src="https://cdn.jsdelivr.net/gh/bbbootstrap/libraries@main/choices.min.js"></script> -->

    <!--===============================================================================================-->
    <link
      rel="stylesheet"
      type="text/css"
      href="<%=url%>/vendor/bootstrap/css/bootstrap.min.css"
    />
    <!--===============================================================================================-->
    <link
      rel="stylesheet"
      type="text/css"
      href="<%=url%>/fonts-1/font-awesome-4.7.0/css/font-awesome.css"
    />
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="<%=url%>/css/main.css" />
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="<%=url%>/css/style_2.css" />
    <link
      rel="stylesheet"
      type="text/css"
      href="<%=url%>/css/Editmanager.css"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="<%=url%>/toastr/toastr.min.css"
    />
    <!--===============================================================================================-->
  </head>

  <body>
    <div class="limiter">
      <div class="container-profile100">
        <div class="header">
          <div class="cover-image100">
            <img src="<%=url%>/logo/logo.png" class="pep-logo" alt="" />
            <a href="#">
              <span class="fa fa-bars menu-button" onclick="openMenu()"></span>
            </a>
            <a href="<%=url%>/manager/notification">
              <span class="fa fa-bell menu-button">
                <span class="button__badge" style="display: none"></span>
              </span>
            </a>
            <nav id="menu">
              <!-- <ul>
            % permissions.forEach(element=> { %>
                <li>
                  <a
                    href="%=url%>/manager%= element.controller%>/%=info.uuid%>"
                  >
                    <span class="%= element.icon%>"></span>
                    %= element.permission_name %>
                  </a>
                </li>
                % }); %>
                <li>
                  <a href="%=url%>/manager/signout">
                    <span class="fa fa-sign-out"> </span> Log Out</a
                  >
                </li>
              </ul> -->
              <span class="fa fa-times close-menu" onclick="closeMenu()"></span>
            </nav>
          </div>
          <!-- --------------------- -->
          <div class="container saleup">
            <br />
            <div class="col-12 text-center" id="ManagerHeading">
              <h2>Managers Details</h2>
            </div>
            <div class="container-lg" id="container_table">
              <div class="table-responsive">
                <div class="table-wrapper">
                  <table class="table table-bordered" id="ManagerDetails">
                    <thead class="table-primary">
                      <tr>
                        <th class="col">Name</th>
                        <th class="col w-50">Zones</th>
                        <th class="col w-50">Status</th>
                        <th class="col">Actions</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr class="p-0">
                        <td>
                          <img
                            src="/img/profile.jpg "
                            class="avatar"
                            alt="Avatar"
                          />
                          Fizza Afzal
                        </td>
                        <td class="td2">Central</td>
                        <td class="form-group">
                          <i class="fa fa-circle text-success status"></i>
                          <label class="active_icon" id="status">Active</label>
                        </td>
                        <td class="padding_class">
                          <a
                            class="add"
                            name="add"
                            title="Add"
                            onclick="update_info(this)"
                            ><i class="fa fa-save"></i
                          ></a>
                          <a
                            name="edit"
                            title="Edit"
                            data-toggle="tooltip "
                            onclick="edit_info(this)"
                            ><i class="text-primary fa fa-pencil"></i
                          ></a>
                          <a
                            class="delete"
                            name="delete"
                            title="Delete"
                            data-toggle="tooltip"
                          >
                            <i
                              class="fa fa-trash"
                              onclick="remove_Row(this)"
                            ></i>
                          </a>
                        </td>
                      </tr>
                      <tr class="p-0">
                        <td>
                          <img
                            src="/img/profile.jpg "
                            class="avatar"
                            alt="Avatar"
                          />
                          Fizza Afzal
                        </td>
                        <td class="td2">Central</td>
                        <td class="form-group">
                          <i class="fa fa-circle text-danger status"></i>
                          <label class="active_icon">Paused</label>
                        </td>
                        <td class="padding_class">
                          <a
                            class="add"
                            name="add"
                            title="Add"
                            onclick="update_info(this)"
                            ><i class="fa fa-save"></i
                          ></a>
                          <a
                            class
                            name="edit"
                            title="Edit"
                            data-toggle="tooltip "
                            onclick="edit_info(this)"
                            ><i class="text-primary fa fa-pencil"></i
                          ></a>
                          <a
                            class="delete"
                            name="delete"
                            title="Delete"
                            data-toggle="tooltip "
                            ><i
                              class="fa fa-trash"
                              onclick="remove_Row(this)"
                            ></i
                          ></a>
                        </td>
                      </tr>
                      <tr class="p-0">
                        <td>
                          <img
                            src="/img/profile.jpg "
                            class="avatar"
                            alt="Avatar"
                          />
                          Fizza Afzal
                        </td>
                        <td class="td2">Central</td>
                        <td class="form-group">
                          <i class="fa fa-circle text-success status"></i>
                          <label class="active_icon">Active</label>
                        </td>
                        <td class="padding_class">
                          <a
                            class="add"
                            name="add"
                            title="Add"
                            onclick="update_info(this)"
                            ><i class="fa fa-save"></i
                          ></a>
                          <a
                            class
                            name="edit"
                            title="Edit"
                            data-toggle="tooltip "
                            onclick="edit_info(this)"
                            ><i class="text-primary fa fa-pencil"></i
                          ></a>
                          <a
                            class="delete"
                            name="delete"
                            title="Delete"
                            data-toggle="tooltip "
                            ><i
                              class="fa fa-trash"
                              onclick="remove_Row(this)"
                            ></i
                          ></a>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!--===============================================================================================-->
    <script src="<%=url%>/js/jquery.min.js"></script>
    <script src="<%=url%>/bootstrap/js/bootstrap.min.js"></script>
    <!-- Toastr -->
    <!--===============================================================================================-->
    <script src="<%=url%>/vendor/jquery/tilt.jquery.min.js"></script>
    <script src="<%=url%>/toastr/toastr.min.js"></script>
    <script>
      //   var notificationCount = JSON.parse(
      //     "%-JSON.stringify(unreadNotificationCount)%>"
      //   );
      //   if (notificationCount) {
      //     $(".button__badge").css("display", "block");
      //     $(".button__badge").html(
      //       JSON.parse("%-JSON.stringify(unreadNotificationCount)%>")
      //     );
      //   }
      //   $(".js-tilt").tilt({
      //     scale: 1.1,
      //   });

      var menu = document.getElementById("menu");
      function openMenu() {
        menu.style.top = "0";
      }
      function closeMenu() {
        menu.style.top = "-100vh";
      }
    </script>
    <script>
      var row_Selected,
        selectList,
        selectArea,
        zone_value,
        status_value,
        node_index;
      /// to edit details about manager!!!!!!!!!!!!
      function edit_info(row) {
        /// if no row selected already, only then edit selected row
        if (document.getElementById("Select_status") == null) {
          row_Selected = "true";
          var tr = document
            .getElementById("ManagerDetails")
            .getElementsByTagName("tr");
          var row_number = row.parentNode.parentNode.rowIndex;

          var td2 = document.createElement("td");
          var td1 = document.createElement("td");
          /// remove edit button and display add button, so user can update manager info.
          tr[row_number]
            .getElementsByTagName("td")[3]
            .children.namedItem("add").style.display = "inline-block";
          tr[row_number]
            .getElementsByTagName("td")[3]
            .children.namedItem("edit").style.display = "none";

          var array = ["Active", "Paused"];
          var area = ["North", "Central", "South"];

          //fetching status and zone values
          status_value = tr[row_number]
            .getElementsByTagName("td")[2]
            .children.item(1).innerText;
          zone_value = tr[row_number].getElementsByTagName("td")[1].innerText;

          /// create select and append options for status.
          selectList = document.createElement("select");
          selectList.id = "Select_status";
          selectList.className = "form-control mt-3 pt-1";
          selectList.selectedIndex = node_index;
          td2.append(selectList);

          array.forEach((element, index) => {
            var option = document.createElement("option");
            option.value = element;
            option.text = element;
            //selecting current option by default
            if (element == status_value) {
              option.selected = true;
            }
            selectList.append(option);
          });
          tr[row_number].getElementsByTagName("td")[2].replaceWith(td2);

          /// create select and append options for zones.
          selectArea = document.createElement("select");
          selectArea.id = "Select_area";
          selectArea.className = "form-control mt-3 pt-1";
          td1.append(selectArea);
          area.forEach((value, index) => {
            var option = document.createElement("option");
            option.value = value;
            option.text = value;
            if (value == zone_value) {
              option.selected = true;
            }
            selectArea.append(option);
          });
          tr[row_number].getElementsByTagName("td")[1].replaceWith(td1);

          /// change colors for disable buttons in all rows.
          // for (var i = 0; i < tr.length; i++) {
          //   if (tr[i] == tr[row_number]) {
          //     $(tr[i]).find(".delete").addClass("text-secondary");
          //   } else {
          //     $(tr[i]).find(".edit").addClass("text-secondary");
          //     $(tr[i]).find(".delete").addClass("text-secondary");
          //   }
          // }
        }
      }

      /// to Update details about manager(after editing)!!!!!!!!!!!!
      function update_info(row) {
        var Select_area = document.getElementById("Select_area");
        row_Selected = null;
        var tr = document
          .getElementById("ManagerDetails")
          .getElementsByTagName("tr");
        var row_number = row.parentNode.parentNode.rowIndex;
        /// remove add/update button and display edit button.
        tr[row_number]
          .getElementsByTagName("td")[3]
          .children.namedItem("edit").style.display = "inline-block";
        tr[row_number]
          .getElementsByTagName("td")[3]
          .children.namedItem("add").style.display = "none";

        /// fetching values of edited status and zone.
        var selectBox = document.getElementById("Select_status");
        var selectBox1 = document.getElementById("Select_area");
        var selected_status = selectBox.options[selectBox.selectedIndex].value;
        var Select_area = selectBox1.options[selectBox1.selectedIndex].value;
        /// changing text in table data.
        if (selected_status == "Active") {
          var td2 = document.createElement("td");
          td2.className = "form-group";
          var tag_i = document.createElement("i");
          tag_i.className = "fa fa-circle text-success status";
          // tag_i.innerText = ""
          td2.append(tag_i);
          var text_label = document.createElement("label");
          text_label.className = "active_icon ml-1";
          text_label.innerHTML = "Active";
          // text_label.innerText = " ";

          td2.append(text_label);

          tr[row_number].getElementsByTagName("td")[2].replaceWith(td2);

          var td1 = document.createElement("td");
          td1.className = "td2";
          td1.innerText = Select_area;

          tr[row_number].getElementsByTagName("td")[1].replaceWith(td1);
        }
        if (selected_status == "Paused") {
          var td2 = document.createElement("td");
          td2.className = "form-group";
          var tag_i = document.createElement("i");
          tag_i.className = "fa fa-circle text-danger status";
          // tag_i.innerText = ""
          td2.append(tag_i);
          var text_label = document.createElement("label");
          text_label.className = "active_icon ml-1";
          text_label.innerHTML = "Paused";
          td2.append(text_label);

          tr[row_number].getElementsByTagName("td")[2].replaceWith(td2);

          var td1 = document.createElement("td");
          td1.className = "td2";
          td1.innerText = Select_area;

          tr[row_number].getElementsByTagName("td")[1].replaceWith(td1);
        }
        /// change colors for enabled buttons in all rows.

        for (var i = 0; i < tr.length; i++) {
          $(tr[i]).find(".edit").removeClass("text-secondary");
          $(tr[i]).find(".delete").removeClass("text-secondary");
        }
      }
      // to remove/delete manager record from table
      function remove_Row(row) {
        if (row_Selected == null) {
          var tr = document
            .getElementById("ManagerDetails")
            .getElementsByTagName("tr");
          var i = row.parentNode.parentNode.parentNode.rowIndex;
          document.getElementById("ManagerDetails").deleteRow(i);
          if (tr.length <= 1) {
            document.getElementById("container_table").style.display = "none";
            document.getElementById("ManagerHeading").style.display = "none";
            var heading = document.createElement("h3");
            heading.innerHTML = "No Managers Available";
            heading.className = "headingtext";
            document.getElementById("container_table").after(heading);
            document.getElementById("SendTeamLead").style.display = "none";
          }
        }
      }
    </script>
  </body>
</html>
